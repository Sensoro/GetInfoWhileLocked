#测试过程

#目的
用于演示如何在锁屏的情况下，在进入一个区域时，获取beacon的信息。在iOS中，锁频后App会进入后台，但是与开着屏幕的情况下进入后台不同，锁屏的情况下，系统会停止某些必要的活动用来节省电量。

#前提条件

* 获取位置更新授权。
	在Info.plist中添加NSLocationAlwaysUsageDescription，以获取“总是使用”位置更新服务。只有这样，SDK才可以在后台激活App。
* 打开蓝牙后台工作模式，作为“central”工作模式。
* 云盒或者云标，云子不支持锁屏情况下获取信息。
* 固件版本3.1
* 打开“增强广播”模式

#测试

##进入测试。
1. 设定设备为指定的uuid，major，minor等。可以通过配置工具的“扫一扫配置”扫描App页面显示的二维码来完成。
2. 离开设备的信号覆盖区域，可以通过断电达到此目的。
3. 启动App，此时App应该是没有检测到相关的设备的。
4. Kill掉App，通过双击Home键，向上划指定的App，来模拟App被Kill调的状况，在实际中，App有可能被系统的资源清理Kill掉。或者重启Kill 掉。关闭掉屏幕。（可以加入开关一次蓝牙）
5. 进入设备的信号覆盖区域，云盒和云标通过上电来达到。
6. 在XCode的Devices窗口中，选中指定的手机，查看手机Log，此时会发现App被重新激活，并输出相应的发现设备的Log

##离开测试

1. 继续上面的步骤，直到Log窗口不再输出此App的Log，即App处于被挂起的状态。此时离开云子的覆盖区域。
2. 在测试用机器上，经过30s后，App会被再次唤醒。并输出离开此 Beacon 覆盖区域的Log，和离开此区域的Log。

##退出后的离开测试。
1. 设定好设备。
2. 在信号覆盖区域内打开App
3. Kill掉App，锁定屏幕。此时在Log窗口应该是看不到此App的Log。
4. 离开信号覆盖区域
5. 查看App的Log，应该只有区域的离开消息。没有离开相关beacon的消息。

__原因：__ 某一个beacon的离开是通过App运行时，是否在这个beacon范围内来判定的。即：如果离开某一个覆盖区域时，App记录了此时是在设备的覆盖区域内的，那么离开时会报告相应的离开时间。但是在此测试中，由于离开时，并没有记录在此beacon范围内，所以也不会有离开此beacon的提示。

##其他测试

切换beacon的不同设定进行试验。

1. 打开防蹭用，关闭防蹭用。
2. 打开传感器，关闭防蹭用。
3. 打开传感器，打开防蹭用。
4. 关闭iBeacon功能。为了进行测试，需要保留此beacon，然后把另外的Beacon设备关闭ibeacon功能，打开“增强广播”模式。此时在锁屏的情况下，可以获取传感器的数据。
5. 关闭ibeacon，打开防蹭用功能。测试方法同上。


#结果
在上面的测试中，都可以在闭屏的情况下获取到相应的SN和电量信息，并且防蹭用功能可用。在关闭iBeacon功能时，可以获取传感器，电量，SN等信息。